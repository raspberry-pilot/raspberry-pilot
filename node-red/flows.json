[{"id":"a97c47d.eafadb8","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"67f2b663.35d018","type":"influxdb","z":"","hostname":"127.0.0.1","port":"8086","protocol":"http","database":"carDB","name":"","usetls":false,"tls":""},{"id":"2e4c5321.531aec","type":"influxdb","z":"","hostname":"localhost","port":"8086","protocol":"http","database":"carDB","name":"","usetls":false,"tls":""},{"id":"76e77d9c.62a764","type":"ui_tab","z":"","name":"Raspberry Pilot","icon":"dashboard","disabled":false,"hidden":false},{"id":"1ae40bf9.e831e4","type":"ui_group","z":"","name":"Raspberry Pilot","tab":"76e77d9c.62a764","disp":true,"width":"6","collapse":false},{"id":"352a00bb.ee937","type":"influxdb in","z":"a97c47d.eafadb8","influxdb":"67f2b663.35d018","name":"Execute Query","query":"","rawOutput":false,"precision":"ms","retentionPolicy":"","x":577,"y":188,"wires":[["f16ca860.3423e8","b9e783d0.3b93b"]]},{"id":"da4adb04.bcb868","type":"function","z":"a97c47d.eafadb8","name":"Generate Query","func":"var query = [\"select v_ego,angle_steers,angle_rate,driver_torque,request,angle_rate_eps,yaw_rate_can,angle_steers_eps,long_accel,p2,p,i,f,damp_angle_steers,damp_angle_steers_des,ff_rate,ff_angle,left_frame,far_right_frame from carState where\",\n             \"select angle_offset,lateral_offset,wheel_speed_fl,wheel_speed_fr,wheel_speed_rl,wheel_speed_rr,l_blinker,r_blinker,lk_mode,enabled,left_frame,left_1,left_2,left_3,left_4,left_5,left_6,left_7,left_8,left_9,left_10,left_11,left_12,left_13,left_full_1,left_full_2,right_frame,right_1,right_2,right_3,right_4,right_5,right_6,right_7,right_8,right_9,right_10,right_11,right_12,right_13,right_full_1,right_full_2,far_left_frame,far_left_1,far_left_2,far_left_3,far_left_4,far_left_5,far_left_6,far_left_7,far_left_8,far_left_9,far_left_10,far_left_11,far_left_12,far_left_13,far_left_full_1,far_left_full_2,far_right_frame,far_right_1,far_right_2,far_right_3,far_right_4,far_right_5,far_right_6,far_right_7,far_right_8,far_right_9,far_right_10,far_right_11,far_right_12,far_right_13,far_right_full_1,far_right_full_2 from carState where (left_1 >= 0 or left_1 <= 0) and \"];\nif (msg.hasOwnProperty('minTime')) {\n    if (msg.minTime !== \"\") { // && msg.statusCode == 200) {\n        msg.payload = {};\n        msg.query = query[msg.topic] + \" time > \" + Number(msg.minTime) + \"ms limit 5000\";    \n        \n        return msg;\n    }\n} \nelse {\n    msg.query = query[msg.topic] + \" time > 0ms limit 5000\";\n    return msg;\n}\n","outputs":1,"noerr":0,"x":377,"y":188,"wires":[["352a00bb.ee937","e2a945d9.fbc0c8"]]},{"id":"f79baf1a.3e5e9","type":"inject","z":"a97c47d.eafadb8","name":"Car Data","topic":"0","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":117,"y":188,"wires":[["da4adb04.bcb868"]]},{"id":"e2a945d9.fbc0c8","type":"debug","z":"a97c47d.eafadb8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":550,"y":243,"wires":[]},{"id":"beb920a1.08d83","type":"inject","z":"a97c47d.eafadb8","name":"Camera Data","topic":"1","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":127,"y":242,"wires":[["da4adb04.bcb868"]]},{"id":"f16ca860.3423e8","type":"debug","z":"a97c47d.eafadb8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":770,"y":243,"wires":[]},{"id":"b9e783d0.3b93b","type":"function","z":"a97c47d.eafadb8","name":"Process Results","func":"if (msg.payload.length == 5000) {\n    msg.minTime = new Date(msg.payload[4999].time);    \n} \nelse {\n    msg.minTime = \"\";\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":797,"y":188,"wires":[["a7d772cb.71317","e322a568.ddc4a8","da4adb04.bcb868"]]},{"id":"a7d772cb.71317","type":"debug","z":"a97c47d.eafadb8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1010,"y":243,"wires":[]},{"id":"e322a568.ddc4a8","type":"zmq-writer","z":"a97c47d.eafadb8","name":"Send to Gernby","mode":"pub","uri":"tcp://192.168.1.212:8594","topic":"","server":false,"x":1117,"y":188,"wires":[]},{"id":"f12c83e7.dc3b9","type":"inject","z":"a97c47d.eafadb8","name":"Get Last Upload Time","topic":"","payload":"","payloadType":"date","repeat":"180","crontab":"","once":false,"onceDelay":0.1,"x":157,"y":73,"wires":[["cf407758.b73e28"]]},{"id":"cf407758.b73e28","type":"zeromq request","z":"a97c47d.eafadb8","name":"Request from Gernby","fields":"payload","server":"tcp://192.168.1.212:8601","output":"string","isserver":false,"intype":"req","x":417,"y":73,"wires":[["d2ff9b92.4e8318"]]},{"id":"d2ff9b92.4e8318","type":"function","z":"a97c47d.eafadb8","name":"Process Result","func":"\nreturn msg;","outputs":1,"noerr":0,"x":667,"y":73,"wires":[["8c007741.2afed8"]]},{"id":"8c007741.2afed8","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":907,"y":73,"wires":[]},{"id":"2a52d87a.8ff088","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":353,"wires":[["c761d4fe.8f17d8"]]},{"id":"cc3ebb6c.63b078","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":353,"wires":[]},{"id":"dafd5690.6fe688","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":573,"wires":[["28da8d30.1f99f2"]]},{"id":"b76e7372.059ac","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":573,"wires":[]},{"id":"3de43130.9a94de","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":623,"wires":[["70e387b8.953fc8"]]},{"id":"aea57dc7.97363","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":623,"wires":[]},{"id":"debe8f92.5f155","type":"ui_button","z":"a97c47d.eafadb8","name":"Enable Live Stream - Button","group":"1ae40bf9.e831e4","order":1,"width":0,"height":0,"passthru":false,"label":"Enable Live Stream","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":376,"y":673,"wires":[["9f2c52f4.7e5d7","448be6b.06dda18"]]},{"id":"3b9c6b1c.8baf54","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":673,"wires":[["debe8f92.5f155"]]},{"id":"9f2c52f4.7e5d7","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":673,"wires":[]},{"id":"c72824c7.697678","type":"ui_button","z":"a97c47d.eafadb8","name":"Upload Now - Button","group":"1ae40bf9.e831e4","order":1,"width":0,"height":0,"passthru":false,"label":"Upload Now","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":356,"y":723,"wires":[["66c552ec.bf917c","448be6b.06dda18"]]},{"id":"d7fe5520.1c1fd8","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":723,"wires":[["c72824c7.697678"]]},{"id":"66c552ec.bf917c","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":723,"wires":[]},{"id":"cd6ed6ff.bd83f8","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":843,"wires":[["da85e6d0.51d148"]]},{"id":"263c6174.569efe","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":843,"wires":[]},{"id":"b7b978a0.5818b8","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":953,"wires":[["efc09ee5.3ff6"]]},{"id":"52aeca8.f1ee934","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":953,"wires":[]},{"id":"da85e6d0.51d148","type":"ui_dropdown","z":"a97c47d.eafadb8","name":"Switch Branch - Dropdown","label":"","tooltip":"","place":"Select option","group":"1ae40bf9.e831e4","order":5,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"","x":375,"y":843,"wires":[["263c6174.569efe","448be6b.06dda18"]]},{"id":"efc09ee5.3ff6","type":"ui_slider","z":"a97c47d.eafadb8","name":"Camera Offset - Slider","label":"Camera Offset","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"outs":"all","topic":"","min":0,"max":10,"step":1,"x":356,"y":953,"wires":[["52aeca8.f1ee934","448be6b.06dda18"]]},{"id":"70e387b8.953fc8","type":"ui_button","z":"a97c47d.eafadb8","name":"Report Lane Fault - Button","group":"1ae40bf9.e831e4","order":1,"width":0,"height":0,"passthru":false,"label":"Report Lane Fault","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":376,"y":623,"wires":[["aea57dc7.97363","448be6b.06dda18"]]},{"id":"28da8d30.1f99f2","type":"ui_button","z":"a97c47d.eafadb8","name":"Report Oscillation - Button","group":"1ae40bf9.e831e4","order":1,"width":0,"height":0,"passthru":false,"label":"Report Oscillation - Button","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":366,"y":573,"wires":[["b76e7372.059ac","448be6b.06dda18"]]},{"id":"c761d4fe.8f17d8","type":"ui_switch","z":"a97c47d.eafadb8","name":"LKAS Mode - Switch","label":"LKAS Mode","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":355,"y":353,"wires":[["cc3ebb6c.63b078","448be6b.06dda18"]]},{"id":"9853da7c.da8ac8","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":403,"wires":[["34b63b71.77e4c4"]]},{"id":"14b3eaff.d710e5","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":403,"wires":[]},{"id":"34b63b71.77e4c4","type":"ui_switch","z":"a97c47d.eafadb8","name":"Auto Resume - Switch","label":"Auto-Resume","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":355,"y":403,"wires":[["14b3eaff.d710e5","448be6b.06dda18"]]},{"id":"956e5fad.7b212","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":453,"wires":[["37da4da9.10c032"]]},{"id":"76902ea7.4259f","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":453,"wires":[]},{"id":"37da4da9.10c032","type":"ui_switch","z":"a97c47d.eafadb8","name":"Allow Gas Press - Switch","label":"Allow Gas Press","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":365,"y":453,"wires":[["76902ea7.4259f","448be6b.06dda18"]]},{"id":"9d953cbf.61543","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":1003,"wires":[["52f1526a.c0171c"]]},{"id":"fa6dd928.eb4f58","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":1003,"wires":[]},{"id":"52f1526a.c0171c","type":"ui_slider","z":"a97c47d.eafadb8","name":"Turn-In Level - Slider","label":"Turn-In Level","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"outs":"all","topic":"","min":0,"max":10,"step":1,"x":356,"y":1003,"wires":[["fa6dd928.eb4f58","448be6b.06dda18"]]},{"id":"dca02622.4f58b8","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":1053,"wires":[["c9b918c.7be9ee8"]]},{"id":"15ff91c3.e4bc9e","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":1053,"wires":[]},{"id":"c9b918c.7be9ee8","type":"ui_slider","z":"a97c47d.eafadb8","name":"Turn-In Delay - Slider","label":"Turn-In Delay","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"outs":"all","topic":"","min":0,"max":10,"step":1,"x":356,"y":1053,"wires":[["15ff91c3.e4bc9e","448be6b.06dda18"]]},{"id":"24a24cc3.42db74","type":"inject","z":"a97c47d.eafadb8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":116,"y":1103,"wires":[["f18e26b5.ed8858"]]},{"id":"8fc3b4a4.9b3918","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1079,"y":1103,"wires":[]},{"id":"f18e26b5.ed8858","type":"ui_slider","z":"a97c47d.eafadb8","name":"Centering Level - Slider","label":"Centering Level","tooltip":"","group":"1ae40bf9.e831e4","order":6,"width":0,"height":0,"passthru":true,"outs":"all","topic":"","min":0,"max":10,"step":1,"x":366,"y":1103,"wires":[["8fc3b4a4.9b3918","448be6b.06dda18"]]},{"id":"a21fc93b.acb728","type":"comment","z":"a97c47d.eafadb8","name":"This handles the uploading of data to the server whenever the server is available","info":"","x":314,"y":148,"wires":[]},{"id":"9cf03f8.10d3ec","type":"comment","z":"a97c47d.eafadb8","name":"This checks for the last successfully uploaded timestamp","info":"","x":246,"y":34,"wires":[]},{"id":"28dc79a9.83db56","type":"comment","z":"a97c47d.eafadb8","name":"This group of switches determine the modes of Raspberry-Pilot","info":"","x":262,"y":311,"wires":[]},{"id":"448be6b.06dda18","type":"function","z":"a97c47d.eafadb8","name":"Process UI Event","func":"\nreturn msg;","outputs":1,"noerr":0,"x":878,"y":788,"wires":[["f3475234.1db6e"]]},{"id":"f3475234.1db6e","type":"debug","z":"a97c47d.eafadb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1080,"y":788,"wires":[]},{"id":"92dd68cc.1320e8","type":"comment","z":"a97c47d.eafadb8","name":"This group of buttons trigger events","info":"","x":171,"y":531,"wires":[]},{"id":"186b39dc.721f86","type":"comment","z":"a97c47d.eafadb8","name":"This is obviously to change the current branch","info":"","x":201,"y":801,"wires":[]},{"id":"1a80aae9.4ef455","type":"comment","z":"a97c47d.eafadb8","name":"These sliders are to adjust the tune","info":"","x":171,"y":911,"wires":[]}]